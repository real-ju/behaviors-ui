import{_ as e}from"./index.81b3e12c.js";import{e as t,f as l,g as a,B as n,o as i,c as o,u as r,_ as u,w as m,a as d,b as s,t as y,r as f,d as c,i as p}from"./index-075d9373.js";import{B as v}from"./index.ae1521ca.js";import{r as h}from"./region.6db33d55.js";import"./index.eb225935.js";import"./index.5a4e8039.js";import"./index.3fe71442.js";import"./index.dd1a0f65.js";const g=u(t({name:"BePicker",options:{virtualHost:!0},props:{visible:{type:Boolean,default:!1},value:{type:[String,Array],default:""},title:{type:String,default:"请选择"},clearText:{type:String,default:"清空"},confirmText:{type:String,default:"确定"},maskCloseAble:{type:Boolean,default:!0},theme:{type:String,default:"#4a68cc"},mode:{type:String,default:"time"},timeFormat:{type:String,default:"yyyy-MM-dd"},timeColumn:{type:Array,default:()=>["year","day"]},timeRange:{type:Object,default:()=>({})},province:{type:String,default:null},regionValueType:{type:String,default:"name"},layout:{type:String,default:"default"}},emits:["update:visible","update:value"],setup(e,{emit:t}){const u=e,m=["second","minute","hour","day","month","year"],d={year:"年",month:"月",day:"日",hour:"时",minute:"分",second:"秒"},s={year:[1970,2030],month:[1,12],day:[1,31],hour:[0,23],minute:[0,59],second:[0,59]},y=[4,6,9,11],f=l([]),c=l([]),p=l();let g=[],b={},x={};const O=a((()=>"time"===u.mode?"value":"region"==u.mode?u.regionValueType:"value")),w=a((()=>"time"===u.mode?"label":"region"==u.mode?"name":"label")),S=a((()=>{let e="";return"time"===u.mode?e="multiple":"region"==u.mode&&(e="cascade"),e}));n((()=>u.value),(()=>{R()})),n((()=>u.visible),(e=>{e&&R()}));const M=e=>{t("update:visible",e)},j=()=>{if("time"===u.mode){f.value.forEach(((e,t)=>{let l=g[t];b[l]=e}));let e=D(b,u.timeFormat);t("update:value",e)}else"region"===u.mode&&t("update:value",f.value);P()},_=()=>{"time"===u.mode?t("update:value",""):"region"===u.mode&&t("update:value",[]),P()},k=(e,t)=>{if("time"===u.mode){let l=g[t];if("year"===l){if(-1!==g.indexOf("day")){let t=g.indexOf("month");2===f.value[t]&&C(e)}}else if("month"===l){-1!==g.indexOf("day")&&C(e)}}},C=e=>{let t=g.indexOf("year"),l=g.indexOf("month"),a=g.indexOf("day"),n=-1!==t?c.value[t][e[t]].value:b.year,i=c.value[l][e[l]].value,o=F("day",n,i);p.value.updateSingleColumn(a,o)},R=()=>{"time"===u.mode?(B(),T(),A(),E()):"region"===u.mode&&(E(),A())},B=()=>{let e={};for(const t in s)if(Object.hasOwnProperty.call(s,t)){let l,a=u.timeRange[t];if(a){if(2!==a.length)throw"timeRange属性不合法";if(a[0]>a[1])throw"timeRange属性不合法";if("year"!==t&&(a[0]<s[t][0]||a[1]>s[t][1]))throw"timeRange属性不合法";l=a}else l=s[t];e[t]=l}x=e},T=()=>{let e=u.timeColumn;if(0===e.length||e.length>2)throw"column属性不合法";1===e.length&&e.push(e[0]);let t=m.indexOf(e[1]),l=m.indexOf(e[0]);if(-1===t||-1===l)throw"column属性不合法";if(t>l)throw"column属性不合法";let a=[];for(let n=l;n>=t;n--)a.push(m[n]);g=a},A=()=>{if("time"===u.mode){let e=new Date,t={year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds()};if(u.value){let e=I(u.value,u.timeFormat);if(null===e)throw"时间格式不合法";for(const l in e)if(Object.hasOwnProperty.call(e,l)){const a=e[l];a&&(t[l]=parseInt(a))}}for(const a in t)if(Object.hasOwnProperty.call(t,a)){let e=x[a][0],l=x[a][1];t[a]<e&&(t[a]=e),t[a]>l&&(t[a]=l)}let l=U(t.year,t.month);t.day>l&&(t.day=l),b=t,f.value=g.map((e=>t[e]))}else"region"===u.mode&&(f.value=u.value)},F=(e,t,l)=>{let a=[],n=d[e],i=x[e],o=i[0],r=i[1];if("day"===e){t&&l||(t=b.year,l=b.month);let e=U(t,l);r=Math.min(e,i[1])}for(let u=o;u<=r;u++)a.push({value:u,label:u+n});return a},E=()=>{if("time"===u.mode){let e=[];g.forEach((t=>{let l=F(t);e.push(l)})),c.value=e}else if("region"===u.mode){let e,t=u.province;e=t?h.filter((e=>e.name===t)):h,c.value=e}},P=()=>{t("update:visible",!1)},U=(e,t)=>{let l=0;if(-1!==y.indexOf(t))l=30;else if(2===t){l=28,(e%4==0&&e%100!=0||e%400==0)&&(l=29)}else l=31;return l},D=(e,t)=>{const l={yyyy:"year",MM:"month",dd:"day",hh:"hour",mm:"minute",ss:"second"};return t.replace(/(yyyy)|(MM)|(dd)|(hh)|(mm)|(ss)/g,(t=>{let a=l[t];return"year"===a?e[a]:String(e[a]).padStart(2,"0")}))},I=(e,t)=>{const l={yyyy:"year",MM:"month",dd:"day",hh:"hour",mm:"minute",ss:"second"};let a=[],n=t.replace(/(yyyy)|(MM)|(dd)|(hh)|(mm)|(ss)/g,(e=>(a.push(e),"yyyy"===e?"(\\d{4})":"(\\d{2})")));n="^"+n+"$";let i=new RegExp(n).exec(e);if(i){let e={year:null,month:null,day:null,hour:null,minute:null,second:null};return i=i.slice(1,a.length+1),i.forEach(((t,n)=>{let i=l[a[n]];e[i]=t})),e}return null};return(t,l)=>(i(),o(v,{mode:r(S),visible:e.visible,"onUpdate:visible":M,value:f.value,"onUpdate:value":l[0]||(l[0]=e=>f.value=e),list:c.value,"value-name":r(O),"label-name":r(w),layout:e.layout,ref_key:"selectRef",ref:p,title:e.title,"clear-text":e.clearText,"confirm-text":e.confirmText,"mask-close-able":e.maskCloseAble,"action-close-able":!1,theme:e.theme,onConfirm:j,onClear:_,onChange:k},null,8,["mode","visible","value","list","value-name","label-name","layout","title","clear-text","confirm-text","mask-close-able","theme"]))}}),[["__scopeId","data-v-97d3072d"]]),b=u(t({__name:"basic",setup(t){const a=l(!1),n=l("");return(t,l)=>{const r=f(c("be-button"),e),u=p,v=f(c("be-picker"),g);return i(),o(u,{class:"playground picker-basic-page"},{default:m((()=>[d(r,{class:"open-btn",hover:"",onClick:l[0]||(l[0]=e=>a.value=!0)},{default:m((()=>[s("打开弹框")])),_:1}),d(u,{class:"model-result"},{default:m((()=>[s("v-model值："+y(n.value),1)])),_:1}),d(v,{title:"标题",visible:a.value,"onUpdate:visible":l[1]||(l[1]=e=>a.value=e),mode:"time",value:n.value,"onUpdate:value":l[2]||(l[2]=e=>n.value=e)},null,8,["visible","value"])])),_:1})}}}),[["__scopeId","data-v-a29c1668"]]);export{b as default};
